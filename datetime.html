<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Время и погода в городах России</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      display: flex;
      justify-content: center;
      align-items: center;
      height: 100vh;
      flex-direction: column;
      background-color: #f0f0f0;
      margin: 0;
    }
    h1 {
      margin-bottom: 20px;
    }
    #time, #weather {
      font-size: 1.5em;
      margin-top: 20px;
    }
  </style>
</head>
<body>
  <h1>Выберите город</h1>
  <select id="city-select">
    <option value="Europe/Moscow">Москва</option>
    <option value="Europe/Samara">Самара</option>
    <option value="Asia/Yekaterinburg">Екатеринбург</option>
    <option value="Asia/Novosibirsk">Новосибирск</option>
    <option value="Asia/Vladivostok">Владивосток</option>
  </select>
  <div id="time"></div>
  <div id="weather"></div>

  <script>
    // API ключ от OpenWeatherMap
    const apiKey = '2cb743256c18de14951f0d50913839be'; // Ваш новый API ключ
    const weatherElement = document.getElementById('weather');
    const timeElement = document.getElementById('time');

    // Словарь с координатами городов (широта и долгота)
    const citiesCoords = {
      "Москва": { lat: 55.7558, lon: 37.6176 },
      "Самара": { lat: 53.1959, lon: 50.1002 },
      "Екатеринбург": { lat: 56.8389, lon: 60.6057 },
      "Новосибирск": { lat: 55.0084, lon: 82.9357 },
      "Владивосток": { lat: 43.1056, lon: 131.8735 },
    };

    // Функция для обновления времени
    function updateTime() {
      const citySelect = document.getElementById('city-select');
      const selectedTimezone = citySelect.value;

      // Получаем текущее время в выбранном часовом поясе
      const now = new Date();
      const timeString = now.toLocaleString('ru-RU', {
        timeZone: selectedTimezone,
        year: 'numeric',
        month: 'long',
        day: 'numeric',
        hour: '2-digit',
        minute: '2-digit',
        second: '2-digit',
      });

      // Обновляем текст на странице
      timeElement.textContent = `Время: ${timeString}`;
    }

    // Функция для получения погоды
    async function getWeather(cityName) {
      const coords = citiesCoords[cityName];
      if (!coords) return;

      const url = `https://api.openweathermap.org/data/2.5/weather?lat=${coords.lat}&lon=${coords.lon}&appid=${apiKey}&units=metric&lang=ru`;

      try {
        const response = await fetch(url);
        const data = await response.json();
        if (data.cod === 200) {
          const weatherDescription = data.weather[0].description;
          const temperature = data.main.temp;
          const humidity = data.main.humidity;
          const windSpeed = data.wind.speed;

          weatherElement.innerHTML = `
            <h2>Погода в ${cityName}</h2>
            <p>Описание: ${weatherDescription}</p>
            <p>Температура: ${temperature}°C</p>
            <p>Влажность: ${humidity}%</p>
            <p>Скорость ветра: ${windSpeed} м/с</p>
          `;
        } else {
          weatherElement.textContent = "Город не найден";
        }
      } catch (error) {
        weatherElement.textContent = "Не удалось загрузить погоду";
      }
    }

    // Обновляем время и погоду при изменении города
    document.getElementById('city-select').addEventListener('change', (event) => {
      const selectedCity = event.target.options[event.target.selectedIndex].text;
      updateTime();
      getWeather(selectedCity);
    });

    // Инициализация времени и погоды при загрузке страницы
    updateTime();
    getWeather("Москва"); // По умолчанию показываем погоду в Москве
    setInterval(updateTime, 1000); // Обновляем время каждую секунду
  </script>
</body>
</html>